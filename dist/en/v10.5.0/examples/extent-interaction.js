"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[5060],{30548:function(e,t,n){var r=n(41564),i=n(87240),o=n(38808),s=n(51541),a=n(25309),l=n(61341),u=n(18381),h=n(16235),c=n(40878),p=n(30470),x=n(23986),d=n(25231),_=n(29810),g=n(88292),v=n(87113);const w="extentchanged";class E extends u.Ay{constructor(e){super(w),this.extent=e}}class f extends v.A{constructor(e){super(e=e||{}),this.on,this.once,this.un,this.condition_=e.condition?e.condition:o.Gk,this.extent_=null,this.pointerHandler_=null,this.pixelTolerance_=void 0!==e.pixelTolerance?e.pixelTolerance:10,this.snappedToVertex_=!1,this.extentFeature_=null,this.vertexFeature_=null,e||(e={}),this.extentOverlay_=new x.A({source:new _.A({useSpatialIndex:!1,wrapX:!!e.wrapX}),style:e.boxStyle?e.boxStyle:y(),updateWhileAnimating:!0,updateWhileInteracting:!0}),this.vertexOverlay_=new x.A({source:new _.A({useSpatialIndex:!1,wrapX:!!e.wrapX}),style:e.pointerStyle?e.pointerStyle:F(),updateWhileAnimating:!0,updateWhileInteracting:!0}),e.extent&&this.setExtent(e.extent)}snapToVertex_(e,t){const n=t.getCoordinateFromPixelInternal(e),r=function(e,t){return(0,l.$x)(n,e)-(0,l.$x)(n,t)},i=this.getExtentInternal();if(i){const o=function(e){return[[[e[0],e[1]],[e[0],e[3]]],[[e[0],e[3]],[e[2],e[3]]],[[e[2],e[3]],[e[2],e[1]]],[[e[2],e[1]],[e[0],e[1]]]]}(i);o.sort(r);const s=o[0];let a=(0,l.sG)(n,s);const u=t.getPixelFromCoordinateInternal(a);if((0,l.Io)(e,u)<=this.pixelTolerance_){const e=t.getPixelFromCoordinateInternal(s[0]),n=t.getPixelFromCoordinateInternal(s[1]),r=(0,l.hG)(u,e),i=(0,l.hG)(u,n),o=Math.sqrt(Math.min(r,i));return this.snappedToVertex_=o<=this.pixelTolerance_,this.snappedToVertex_&&(a=r>i?s[1]:s[0]),a}}return null}handlePointerMove_(e){const t=e.pixel,n=e.map;let r=this.snapToVertex_(t,n);r||(r=n.getCoordinateFromPixelInternal(t)),this.createOrUpdatePointerFeature_(r)}createOrUpdateExtentFeature_(e){let t=this.extentFeature_;return t?e?t.setGeometry((0,p.VY)(e)):t.setGeometry(void 0):(t=e?new s.A((0,p.VY)(e)):new s.A({}),this.extentFeature_=t,this.extentOverlay_.getSource().addFeature(t)),t}createOrUpdatePointerFeature_(e){let t=this.vertexFeature_;if(t){t.getGeometry().setCoordinates(e)}else t=new s.A(new c.A(e)),this.vertexFeature_=t,this.vertexOverlay_.getSource().addFeature(t);return t}handleEvent(e){return!e.originalEvent||!this.condition_(e)||(e.type!=a.A.POINTERMOVE||this.handlingDownUpSequence||this.handlePointerMove_(e),super.handleEvent(e),!1)}handleDownEvent(e){const t=e.pixel,n=e.map,r=this.getExtentInternal();let i=this.snapToVertex_(t,n);const o=function(e){let t=null,n=null;return e[0]==r[0]?t=r[2]:e[0]==r[2]&&(t=r[0]),e[1]==r[1]?n=r[3]:e[1]==r[3]&&(n=r[1]),null!==t&&null!==n?[t,n]:null};if(i&&r){const e=i[0]==r[0]||i[0]==r[2]?i[0]:null,t=i[1]==r[1]||i[1]==r[3]?i[1]:null;null!==e&&null!==t?this.pointerHandler_=m(o(i)):null!==e?this.pointerHandler_=I(o([e,r[1]]),o([e,r[3]])):null!==t&&(this.pointerHandler_=I(o([r[0],t]),o([r[2],t])))}else i=n.getCoordinateFromPixelInternal(t),this.setExtent([i[0],i[1],i[0],i[1]]),this.pointerHandler_=m(i);return!0}handleDragEvent(e){if(this.pointerHandler_){const t=e.coordinate;this.setExtent(this.pointerHandler_(t)),this.createOrUpdatePointerFeature_(t)}}handleUpEvent(e){this.pointerHandler_=null;const t=this.getExtentInternal();return t&&0!==(0,h.UG)(t)||this.setExtent(null),!1}setMap(e){this.extentOverlay_.setMap(e),this.vertexOverlay_.setMap(e),super.setMap(e)}getExtent(){return(0,d.JR)(this.getExtentInternal(),this.getMap().getView().getProjection())}getExtentInternal(){return this.extent_}setExtent(e){this.extent_=e||null,this.createOrUpdateExtentFeature_(e),this.dispatchEvent(new E(this.extent_))}}function y(){const e=(0,g.mY)();return function(t,n){return e.Polygon}}function F(){const e=(0,g.mY)();return function(t,n){return e.Point}}function m(e){return function(t){return(0,h.Tr)([e,t])}}function I(e,t){return e[0]==t[0]?function(n){return(0,h.Tr)([e,[n[0],t[1]]])}:e[1]==t[1]?function(n){return(0,h.Tr)([e,[t[0],n[1]]])}:null}var A=f,P=n(12185),T=n(28e3);const O=new r.A({layers:[new P.A({source:new T.A})],target:"map",view:new i.Ay({center:[0,0],zoom:2})}),M=new A({condition:o.Kg});O.addInteraction(M)}},function(e){var t;t=30548,e(e.s=t)}]);
//# sourceMappingURL=extent-interaction.js.map