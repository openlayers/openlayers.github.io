{"version":3,"file":"kml-earthquakes.js","mappings":"uNAYA,MAAMA,EAAa,CAAC,EA2BdC,EAAS,IAAI,IAAY,CAC7BC,OAAQ,IAAI,IAAa,CACvBC,IAAK,qCACLC,OAAQ,IAAI,KAAI,CACdC,eAAe,MAGnBC,MAjCoB,SAAUC,GAI9B,MAAMC,EAAOD,EAAQE,IAAI,QAEnBC,EAAS,EAAI,IADDC,WAAWH,EAAKI,OAAO,IACJ,GACrC,IAAIN,EAAQN,EAAWU,GAgBvB,OAfKJ,IACHA,EAAQ,IAAI,KAAM,CAChBO,MAAO,IAAI,IAAY,CACrBH,OAAQA,EACRI,KAAM,IAAI,IAAK,CACbC,MAAO,2BAETC,OAAQ,IAAI,IAAO,CACjBD,MAAO,yBACPE,MAAO,QAIbjB,EAAWU,GAAUJ,GAEhBA,CACT,IAYMY,EAAS,IAAI,IAAU,CAC3BhB,OAAQ,IAAI,IAAW,CACrBiB,MAAO,mBAILC,EAAM,IAAI,IAAI,CAClBC,OAAQ,CAACH,EAAQjB,GACjBqB,OAAQ,MACRC,KAAM,IAAI,KAAK,CACbC,OAAQ,CAAC,EAAG,GACZC,KAAM,MAIJC,EAAOC,SAASC,eAAe,QACrCF,EAAKpB,MAAMuB,cAAgB,OAC3B,MAAMC,EAAU,IAAIC,UAAUC,QAAQN,EAAM,CAC1CO,WAAW,EACXC,YAAa,UACbC,OAAQ,CAAC,EAAG,GACZC,MAAO,IACPC,QAAS,WAGX,IAAIC,EACJ,MAAMC,EAAqB,SAAUC,EAAOlB,GAC1C,MAAMf,EAAUe,EAAOmB,QAAQ,oBAC3BC,EACAtB,EAAIuB,sBAAsBH,GAAO,SAAUjC,GACzC,OAAOA,CACT,IACAA,GACFmB,EAAKpB,MAAMsC,KAAOJ,EAAM,GAAK,KAC7Bd,EAAKpB,MAAMuC,IAAML,EAAM,GAAK,KACxBjC,IAAY+B,GACdR,EAAQgB,WAAW,CAAC,iBAAkBvC,EAAQE,IAAI,UAEhD6B,EACFR,EAAQiB,SAERjB,EAAQkB,QAGVlB,EAAQmB,OAEVX,EAAiB/B,CACnB,EAEAa,EAAI8B,GAAG,eAAe,SAAUC,GAC9B,GAAIA,EAAIC,SAGN,OAFAtB,EAAQmB,YACRX,OAAiBI,GAGnBH,EAAmBY,EAAIX,MAAOW,EAAIE,cAAc/B,OAClD,IAEAF,EAAI8B,GAAG,SAAS,SAAUC,GACxBZ,EAAmBY,EAAIX,MAAOW,EAAIE,cAAc/B,OAClD,IAEAF,EAAIkC,mBAAmBC,iBAAiB,gBAAgB,WACtDzB,EAAQmB,OACRX,OAAiBI,CACnB,G","sources":["webpack:///./kml-earthquakes.js"],"sourcesContent":["import Map from '../src/ol/Map.js';\nimport View from '../src/ol/View.js';\nimport KML from '../src/ol/format/KML.js';\nimport TileLayer from '../src/ol/layer/Tile.js';\nimport VectorLayer from '../src/ol/layer/Vector.js';\nimport StadiaMaps from '../src/ol/source/StadiaMaps.js';\nimport VectorSource from '../src/ol/source/Vector.js';\nimport CircleStyle from '../src/ol/style/Circle.js';\nimport Fill from '../src/ol/style/Fill.js';\nimport Stroke from '../src/ol/style/Stroke.js';\nimport Style from '../src/ol/style/Style.js';\n\nconst styleCache = {};\nconst styleFunction = function (feature) {\n  // 2012_Earthquakes_Mag5.kml stores the magnitude of each earthquake in a\n  // standards-violating <magnitude> tag in each Placemark.  We extract it from\n  // the Placemark's name instead.\n  const name = feature.get('name');\n  const magnitude = parseFloat(name.substr(2));\n  const radius = 5 + 20 * (magnitude - 5);\n  let style = styleCache[radius];\n  if (!style) {\n    style = new Style({\n      image: new CircleStyle({\n        radius: radius,\n        fill: new Fill({\n          color: 'rgba(255, 153, 0, 0.4)',\n        }),\n        stroke: new Stroke({\n          color: 'rgba(255, 204, 0, 0.2)',\n          width: 1,\n        }),\n      }),\n    });\n    styleCache[radius] = style;\n  }\n  return style;\n};\n\nconst vector = new VectorLayer({\n  source: new VectorSource({\n    url: 'data/kml/2012_Earthquakes_Mag5.kml',\n    format: new KML({\n      extractStyles: false,\n    }),\n  }),\n  style: styleFunction,\n});\n\nconst raster = new TileLayer({\n  source: new StadiaMaps({\n    layer: 'stamen_toner',\n  }),\n});\n\nconst map = new Map({\n  layers: [raster, vector],\n  target: 'map',\n  view: new View({\n    center: [0, 0],\n    zoom: 2,\n  }),\n});\n\nconst info = document.getElementById('info');\ninfo.style.pointerEvents = 'none';\nconst tooltip = new bootstrap.Tooltip(info, {\n  animation: false,\n  customClass: 'pe-none',\n  offset: [0, 5],\n  title: '-',\n  trigger: 'manual',\n});\n\nlet currentFeature;\nconst displayFeatureInfo = function (pixel, target) {\n  const feature = target.closest('.ol-control')\n    ? undefined\n    : map.forEachFeatureAtPixel(pixel, function (feature) {\n        return feature;\n      });\n  if (feature) {\n    info.style.left = pixel[0] + 'px';\n    info.style.top = pixel[1] + 'px';\n    if (feature !== currentFeature) {\n      tooltip.setContent({'.tooltip-inner': feature.get('name')});\n    }\n    if (currentFeature) {\n      tooltip.update();\n    } else {\n      tooltip.show();\n    }\n  } else {\n    tooltip.hide();\n  }\n  currentFeature = feature;\n};\n\nmap.on('pointermove', function (evt) {\n  if (evt.dragging) {\n    tooltip.hide();\n    currentFeature = undefined;\n    return;\n  }\n  displayFeatureInfo(evt.pixel, evt.originalEvent.target);\n});\n\nmap.on('click', function (evt) {\n  displayFeatureInfo(evt.pixel, evt.originalEvent.target);\n});\n\nmap.getTargetElement().addEventListener('pointerleave', function () {\n  tooltip.hide();\n  currentFeature = undefined;\n});\n"],"names":["styleCache","vector","source","url","format","extractStyles","style","feature","name","get","radius","parseFloat","substr","image","fill","color","stroke","width","raster","layer","map","layers","target","view","center","zoom","info","document","getElementById","pointerEvents","tooltip","bootstrap","Tooltip","animation","customClass","offset","title","trigger","currentFeature","displayFeatureInfo","pixel","closest","undefined","forEachFeatureAtPixel","left","top","setContent","update","show","hide","on","evt","dragging","originalEvent","getTargetElement","addEventListener"],"sourceRoot":""}