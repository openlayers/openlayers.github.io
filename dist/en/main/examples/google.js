"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[7922],{74846:function(e,t,i){var s=i(41564),o=i(87240),r=i(73988),n=i(76825),a=i(96256),h=i(94679),l=i(16235),c=i(25231),p=i(10135),u=i(38376);class y extends u.A{constructor(e){const t=!!e.highDpi;super({attributionsCollapsible:e.attributionsCollapsible,cacheSize:e.cacheSize,crossOrigin:"anonymous",interpolate:e.interpolate,projection:"EPSG:3857",reprojectionErrorThreshold:e.reprojectionErrorThreshold,state:"loading",tileLoadFunction:e.tileLoadFunction,tilePixelRatio:t?2:1,wrapX:void 0===e.wrapX||e.wrapX,transition:e.transition,zDirection:e.zDirection}),this.apiKey_=e.key,this.error_=null;const i={mapType:e.mapType||"roadmap",language:e.language||"en-US",region:e.region||"US"};e.imageFormat&&(i.imageFormat=e.imageFormat),e.scale&&(i.scale=e.scale),t&&(i.highDpi=!0),e.layerTypes&&(i.layerTypes=e.layerTypes),e.styles&&(i.styles=e.styles),!0===e.overlay&&(i.overlay=!0),e.apiOptions&&(i.apiOptions=e.apiOptions),this.sessionTokenRequest_=i,this.sessionTokenValue_,this.sessionRefreshId_,this.previousViewportAttribution_,this.previousViewportExtent_;const s=e.url||"https://tile.googleapis.com/";this.createSessionUrl_=s+"v1/createSession",this.tileUrl_=s+"v1/2dtiles",this.attributionUrl_=s+"tile/v1/viewport",this.createSession_()}getError(){return this.error_}fetchSessionToken(e,t){return fetch(e,t)}async createSession_(){const e=this.createSessionUrl_+"?key="+this.apiKey_,t={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(this.sessionTokenRequest_)},i=await this.fetchSessionToken(e,t);if(!i.ok){try{const e=await i.json();this.error_=new Error(e.error.message)}catch{this.error_=new Error("Error fetching session token")}return void this.setState("error")}const s=await i.json(),o=this.getTilePixelRatio(1),r=[s.tileWidth/o,s.tileHeight/o];this.tileGrid=(0,p.EN)({extent:(0,p.kZ)(this.getProjection()),maxZoom:22,tileSize:r});const n=s.session;this.sessionTokenValue_=n;const a=this.apiKey_,h=this.tileUrl_;this.tileUrlFunction=function(e,t,i){const s=e[0],o=e[1],r=e[2];return`${h}/${s}/${o}/${r}?session=${n}&key=${a}`};const l=1e3*parseInt(s.expiry,10),c=Math.max(l-Date.now()-6e4,1);this.sessionRefreshId_=setTimeout((()=>this.createSession_()),c),this.setAttributions(this.fetchAttributions_.bind(this)),this.setState("ready")}async fetchAttributions_(e){if(e.viewHints[h.A.ANIMATING]||e.viewHints[h.A.INTERACTING]||e.animate)return this.previousViewportAttribution_;const[t,i]=(0,c.WP)((0,l.R)(e.extent),e.viewState.projection),[s,o]=(0,c.WP)((0,l.WU)(e.extent),e.viewState.projection),r=`zoom=${this.getTileGrid().getZForResolution(e.viewState.resolution,this.zDirection)}&north=${o}&south=${i}&east=${s}&west=${t}`;if(this.previousViewportExtent_==r)return this.previousViewportAttribution_;this.previousViewportExtent_=r;const n=this.sessionTokenValue_,a=this.apiKey_,p=`${this.attributionUrl_}?session=${n}&key=${a}&${r}`;return this.previousViewportAttribution_=await fetch(p).then((e=>e.json())).then((e=>e.copyright)),this.previousViewportAttribution_}disposeInternal(){clearTimeout(this.sessionRefreshId_),super.disposeInternal()}}var g=y;document.getElementById("key-form").addEventListener("submit",(e=>{!function(e){const t=new g({key:e,scale:"scaleFactor2x",highDpi:!0});t.on("change",(()=>{"error"===t.getState()&&alert(t.getError())}));class i extends r.A{constructor(){const e=document.createElement("img");e.style.pointerEvents="none",e.style.position="absolute",e.style.bottom="5px",e.style.left="5px",e.src="https://developers.google.com/static/maps/documentation/images/google_on_white.png",super({element:e})}}new s.A({layers:[new a.A({source:t})],controls:(0,n.N)().extend([new i]),target:"map",view:new o.Ay({center:[0,0],zoom:2})})}(e.target.elements.key.value)}))}},function(e){var t;t=74846,e(e.s=t)}]);
//# sourceMappingURL=google.js.map